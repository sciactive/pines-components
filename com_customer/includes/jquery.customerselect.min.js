/*
 * jQuery Customer Select (customerselect) Plugin 1.0.0
 *
 * Copyright (c) 2010 Hunter Perrin
 *
 * Licensed (along with all of Pines) under the GNU Affero GPL:
 *	  http://www.gnu.org/licenses/agpl.html
 */

(function(e){e.fn.customerselect=function(t){var n=this;n.each(function(){var n=e(this);n.customerselect_version="1.0.0";if(n.hasClass("ui-customerselect"))return true;n.addClass("ui-customerselect");var r={minLength:2,source:function(t,n){e.ajax({url:pines.com_customer_autocustomer_url,dataType:"json",data:{q:t.term},success:function(t){if(!t){n([]);return}n(e.map(t,function(e){return{id:pines.safe(e.guid),label:pines.safe(e.name),value:e.guid+": "+e.name,desc:"<em><pre>"+(e.email?" "+pines.safe(e.email):"")+(e.phone_cell?" "+pines.safe(e.phone_cell):e.phone_home?" "+pines.safe(e.phone_home):e.phone_work?" "+pines.safe(e.phone_work):"")+"</pre></em>"}}))}})}};if(typeof t!="undefined")e.extend(r,t);n.autocomplete(r).data("autocomplete")._renderItem=function(t,n){return e("<li></li>").data("item.autocomplete",n).append("<a><strong>"+n.label+"</strong><br />"+n.desc+"</a>").appendTo(t)};this.pines_customerselect=n});return n}})(jQuery);