pines(function(){function A(e,t,n){if(!displayNotifications){return}if(Notification.permission==="granted"){var r=new Notification(e,{body:t,tag:n})}else if(Notification.permission!=="denied"){Notification.requestPermission(function(r){if(!("permission"in Notification)){Notification.permission=r}if(r==="granted"){var i=new Notification(e,{body:t,tag:n})}})}}function O(e,t,n,r){channel_id=e;channel_token=t;channel_username=n;channel_guid=r;F()}function M(){connectedToChannel=true;E.removeClass("offline checking");if(Lt=="open"&&$(window).width()>768){v.click()}b.removeClass("icon-spin icon-spinner icon-ban-circle");St();et()}function _(e){var t=JSON.parse(e.data);if(t!==undefined){if(t.type=="connection"){ot(t.user);gt();lt(t.user.channel_id);U(t.user.channel_id)}else if(t.type=="disconnection"){Q(t.channel_id);gt()}else if(t.type=="message"){ut(t.message,true);kt()}else if(t.type=="online_check"){X(t)}else if(t.type=="customer_check"){z(t)}else if(t.type=="customer_update"){st(t.user)}else if(t.type=="connection_update"){R(t.connected_clients,t.disconnected_clients)}}}function D(e){if(e.code=="401"){needToRestartChannels=true}}function P(){E.addClass("offline");r.addClass("chat-minimized");$("body").removeClass("chat-mobile-open");St();b.removeClass("icon-chevron-down icon-chevron-down icon-spin icon-spinner").addClass("icon-ban-circle");connectedToChannel=false;if(needToRestartChannels){B()}}function H(e,t,n,r){var i=$("#"+e+"-div");if(!i.length)return;i.find(".chat-client-div-info").html(t.capitalize()+", "+n.capitalize());i.find(".last-page-url").html('<a href="'+r+'" target="_blank">'+r+"</a>")}function B(){needToRestartChannels=false;Y("true")}function j(){document.getElementById("channel-notification").pause();document.getElementById("channel-notification").play()}function F(){channel=null;socket=null;channel=new goog.appengine.Channel(channel_token);socket=channel.open();socket.onopen=M;socket.onmessage=_;socket.onerror=D;socket.onclose=P}function I(){var e=$(".chat-window");i.find(".chat-indicator").removeClass("active");e.removeClass("open");setTimeout(function(){e.hide()},1e3)}function q(e,t,n){$(".chat-window").removeClass("open").hide();var r=$("#"+e);var i=r.find(".chat-body");setTimeout(function(){r.find(".chat-message").removeClass("flash")},4e3);ht();r.find(".convo-link").attr("href",n);r.find(".convo-location").text(t);r.css("display","block");setTimeout(function(){r.addClass("open");var t=document.getElementById(e+"-chat-body");i.animate({scrollTop:t.scrollHeight},300)},300);r.find(".chat-footer").show()}function R(e,t){var n=e.length;var r=t.length;for(var i=0;i<n;i++){var s=e[i];var o=$("#"+s+"-div");o.show();o.find(".chat-indicator").removeClass("offline checking");if(typeof disconnect_timeouts[s]==="undefined")continue;if(disconnect_timeouts[s].length){for(var u in disconnect_timeouts[s]){clearTimeout(u)}disconnect_timeouts[s]=[]}}for(var i=0;i<r;i++){var a=t[i];var f=$("#"+a+"-div");f.hide();f.find(".chat-indicator").removeClass("checking").addClass("offline")}gt()}function U(e){if(e===channel_id)return;if(customer_chat_histories[e]!=="undefined"){return}$.ajax({type:"GET",url:getMessagesURL,data:{customer_channel:e,channel_token:channel_token,channel_id:channel_id},crossDomain:true,dataType:"json",success:function(t){if(t.status==="success"){customer_chat_histories[e]=true;Z(t.messages)}},error:function(){}})}function z(e){var t="#"+e.channel_id+"-div";$(t).show();$(t).find(".chat-indicator").removeClass("offline checking");if(typeof disconnect_timeouts[e.channel_id]==="undefined"){disconnect_timeouts[e.channel_id]=[];return}if(disconnect_timeouts[e.channel_id].length){for(var n in disconnect_timeouts[e.channel_id]){clearTimeout(n)}disconnect_timeouts[e.channel_id]=[]}if(typeof e.page_url!=="undefined")at(t,e.page_url)}function W(e){var t=$("#"+e+"-div").find(".chat-indicator");t.removeClass("offline").addClass("checking");if(typeof disconnect_timeouts[e]==="undefined"){disconnect_timeouts[e]=[]}var n=setTimeout(function(){if(disconnect_timeouts[e].length){t.removeClass("checking").addClass("offline");disconnect_timeouts[e]=[];rt();gt()}else{}},5e3);disconnect_timeouts[e].push(n);$.ajax({type:"POST",url:onlineCheckURL,data:{customer_channel:e,channel_token:channel_token,channel_id:channel_id},crossDomain:true,dataType:"json",success:function(){},error:function(){}})}function X(){$.ajax({type:"POST",url:onlineTestURL,data:{channel_token:channel_token,channel_id:channel_id},crossDomain:true,dataType:"json",success:function(){},error:function(){}})}function V(e){var t=e.length;if(!t){return}for(var n=0;n<t;n++){ot(e[n])}gt()}function J(e){return(new Date(Number(e))).toISOString()}function K(e){if(!displayNotifications)return;var t=setInterval(function(){if($(e).hasClass("alert-info")){$(e).removeClass("alert-info")}else{$(e).addClass("alert-info")}},1e3);var n=setTimeout(function(){clearInterval(t);$(e).addClass("alert-info")},5e3);$(e).on("click",function(){clearInterval(t);clearTimeout(n);$(e).removeClass("alert-info")})}function Q(e){var t=$("#"+e+"-div").find(".chat-indicator");if(typeof disconnect_timeouts[e]==="undefined"){disconnect_timeouts[e]=[]}var n=setTimeout(function(){t.removeClass("checking").addClass("offline");$("#"+e+"-div").hide();disconnect_timeouts[e]=[];rt();gt()},1e4);disconnect_timeouts[e].push(n)}function G(e,t){if(connectedToChannel){var n=(new Date).getTime();$.ajax({type:"POST",url:sendMessageURL,data:{to_channel:t,msg:e,from_channel:channel_id,timestamp:n,channel_token:channel_token,channel_id:channel_id},crossDomain:true,dataType:"json",success:function(e){},error:function(){$("#"+t+"-chat").append("<li><p>There was an error sending the message.</p></li>")}})}else{Y()}}function Y(e){E.removeClass("offline").addClass("checking");b.removeClass("icon-chevron-down icon-chevron-down icon-ban-circle").addClass("icon-spin icon-spinner");var t=getTokenURL;$.ajax({type:"POST",url:t,data:{force_new_token:e},dataType:"json",success:function(e){O(e.channel_id,e.channel_token,e.username,e.guid);r.removeClass("hide")},error:function(){alert("Could not get a token. Please refresh your page")}})}function Z(e){var t=e.length;if(!t)return;displayNotifications=false;for(var n=0;n<t;n++){var r=e[n];if(typeof chatHistory[r.message_id]==="undefined"&&$("#"+r.channel_id).length){ut(r,false)}}displayNotifications=true}function et(){$.ajax({type:"GET",url:getUsersPlusMessagesURL,data:{token:channel_token,channel_id:channel_id},dataType:"json",crossDomain:true,success:function(e){if(e.status=="success"){var t=e.users.length;for(var n=0;n<t;n++){ot(e.users[n].user);lt(e.users[n].user.channel_id);Z(e.users[n].messages)}kt();gt()}},error:function(){}})}function tt(){for(var e in connected_clients){disconnect_timeouts[e.channel_id]=[]}setTimeout(function(){for(var e in connected_clients){if(disconnect_timeouts[e.channel_id].length){nt(e)}}},8e3);$.ajax({type:"POST",url:pingAllCustomersURL,data:{channel_token:channel_token,channel_id:channel_id},dataType:"json",crossDomain:true,success:function(){},error:function(){}})}function nt(e){var t=$(connected_clients[e]["chat_div"]);t.hide();t.find(".chat-indicator").removeClass("checking").addClass("offline")}function rt(){$.ajax({type:"GET",url:refreshOnlineUsersURL,data:{channel_token:channel_token,channel_id:channel_id},dataType:"json",crossDomain:true,success:function(e){if(e.status=="success"){V(e.users)}},error:function(){}})}function it(e){var t=e.length;if(!t)return;for(var n=0;n<t;n++){ot(e[n]);lt(e[n])}gt()}function st(e){if(typeof e==="undefined")return;var t=connected_clients[e.channel_id];if(Object.keys(t).length===0){connected_clients[e.channel_id]={}}for(var n in e){if(e.hasOwnProperty(n)){connected_clients[e.channel_id][n]=e[n]}}var r="#"+e.channel_id+"-div";ft(r,e.city,e.region)}function ot(e){if(e.channel_id==channel_id){return}var t=disconnect_timeouts[e.channel_id];if(typeof t!=="undefined"&&t.length){for(var n in disconnect_timeouts[e.channel_id]){clearTimeout(n)}disconnect_timeouts[e.channel_id]=[]}connected_clients[e.channel_id]={};for(var r in e){if(e.hasOwnProperty(r)){connected_clients[e.channel_id][r]=e[r]}}var i=e.channel_id+"-div";if($("#"+i).length){$("#"+i).show();$("#"+e.channel_id+"-div").find(".chat-indicator").removeClass("offline checking");return}if(Boolean(e.is_employee)){var s='<div class="list-group employee-channel-clients-list channel-client-list" id="'+e.channel_id+'-div" data-channelid="'+e.channel_id+'"><div class="chat-indicator main-trans"><i class="icon-chevron-right"></i></div><a class="list-group-item channel-name-div">'+'<strong class="chat-client-div-username">'+e.username+"</strong>"+'<input type="text" style="display:none;" value="'+e.channel_id+'"/>'+"</a></div>";$("#employee-chat-clients").append(s)}else{var o="nondistinguished-chat-user";var u="";if(Boolean(e.distinguished)){o="distinguished-chat-user";u="Employee "}var a=e.username;if(Boolean(e.username_link)){var f=/[\?\&\=]/;if(f.test(e.username_link)){a='<a href="'+e.username_link+'" target="_blank">'+e.username+"</a>"}}connected_clients[e.channel_id].username_link=a;var l='<span class="chat-client-div-info badge"></span>';if(e.city){l='<span class="chat-client-div-info badge">'+e.city.capitalize()+", "+e.region.capitalize()+"</span>"}var c='<div class="list-group customer-channel-clients-list channel-client-list '+o+'" id="'+e.channel_id+'-div" data-channelid="'+e.channel_id+'"><div class="chat-indicator main-trans"><i class="icon-chevron-right"></i></div><div class="list-group-item channel-name-div">'+'<strong class="chat-client-div-username">'+u+e.username+"</strong>"+l+'<p class="last-chat-message chat-ellipsis"></p>'+'<p class="last-page-url chat-ellipsis"><a href="'+e.page_url+'" target="_blank">'+e.page_url+"</a>"+"</p>"+'<input type="text" style="display:none;" value="'+e.channel_id+'"/>'+"</div></div>";$("#customer-chat-clients").append(c)}}function ut(e,r){var i;var s;var o;var u=e.from_channel===channel_id;var a;var f=J(e.timestamp);var l=e.from_username;if(Boolean(e.channel_id)){i="#"+e.channel_id+"-chat";o="#"+e.channel_id+"-chat-body";a="#"+e.channel_id+"-div"}else if(u){if(Boolean(e.employee_to_employee)){i="#"+e.to_channel+"-chat";o="#"+e.to_channel+"-chat-body";a="#"+e.to_channel+"-div"}else{i="#"+e.channel_id+"-chat";o="#"+e.channel_id+"-chat-body";a="#"+e.channel_id+"-div"}}else{i="#"+e.from_channel+"-chat";o="#"+e.from_channel+"-chat-body";a="#"+e.from_channel+"-div"}if(u){s='<li class="chat-message main-trans"><span class="chat-img pull-right"><img src="'+t+'" alt="User Avatar" class="img-circle"/></span>'+'<div class="chat-message-right clearfix"><div class="header">'+'<small class="text-muted">'+'<i class="icon-time"></i><abbr class="timeago chat-timeago" title="'+f+'">'+f+"</abbr></small>"+'<strong class="pull-right primary-font">'+l+"</strong>"+"</div><p>"+e.message+"</p></div></li>"}else{s='<li class="chat-message main-trans"><span class="chat-img pull-left"><img src="'+n+'" alt="User Avatar" class="img-circle"/></span>'+'<div class="chat-message-left clearfix"><div class="header"><strong class="primary-font">'+l+"</strong> "+'<small class="pull-right text-muted">'+'<i class="icon-time"></i><abbr class="timeago chat-timeago" title="'+f+'">'+f+"</abbr></small></div>"+"<p>"+e.message+"</p></div></li>";at(a,e.page_url);if(N>768)A(l,e.message,l);K(a)}$(i).append(s);$(o).scrollTop($(i).height());$(a).find(".last-chat-message").html(e);chatHistory[e.message_id]=e;if(r&&!$(i).closest(".chat-window").hasClass("open")){$(i).find(".chat-message").last().addClass("flash")}$("abbr.timeago").timeago()}function at(e,t){if(typeof t==="undefined"||!Boolean(t))return;$(e).find(".last-page-url").html('<a href="'+t+'" target="_blank">'+t+"</a>")}function ft(e,t,n){$(e).find(".badge").html(t.capitalize()+", "+n.capitalize())}function lt(e){if($("#"+e).length||e==channel_id){return}var t=connected_clients[e];var n="";var r="";var i='<div class="container chat-window chat-container main-trans" id="'+e+'"><div class="row chat-header" data-channelid="'+e+'">'+'<span class="chat-username">'+t.username_link+'</span><div class="btn-group pull-right" style="display:none;">'+'<button type="button" class="btn btn-small min-max-btn" data-channelid="'+e+'"><i class="icon-chevron-down"></i></button>'+'<button type="button" class="btn btn-small close-chat-btn" data-channelid="'+e+'"><i class="icon-remove"></i></button>'+'<button type="button" class="btn btn-small dropdown-toggle" data-toggle="dropdown">'+'<i class="icon-wrench"></i></button><ul class="dropdown-menu slidedown"><li>'+'<a href="#" class="do-online-check" data-channelid="'+e+'"><i class="icon-chevron-right"></i> Online Check</a></li></ul>'+'</div><a class="convo-link convo-btns" title="Viewing Page..." href="'+r+'" target="_blank"><i class="icon-globe"></i></a><span class="convo-refresh do-online-check convo-btns" title="Check Online" data-channelid="'+e+'"><i class="icon-refresh"></i></span>'+'<span class="convo-close close-chat-btn convo-btns" title="Close Convo"><i class="icon-remove"></i></span><div class="convo-location"> '+n+' </div></div><div class="row chat-body" id="'+e+'-chat-body">'+'<ul class="chat-window-messages" id="'+e+'-chat"></ul></div><div class="row chat-footer">'+'<div class="input-append chat-message-input"><input id="'+e+'-btn-input" data-channelid="'+e+'" type="text" class="form-control chat-input-box" placeholder="Type Message Here...">'+'<span class="input-group-btn"><button  type="button" class="btn btn-warning chat-button send-chat-btn" data-channelid="'+e+'">Send</button>'+"</span></div></div></div>";additionalClients.append(i)}function ct(e){var t=$(window).width();var n=$(window).height();var o=s.outerHeight();var u=$("#nav").outerHeight();var a=v.outerHeight();var f=n-(u+o+a)-(i.outerHeight()-i.height())+10;var l=n-(a+u)+10;if(t<768&&!r.hasClass("chat-minimized")){$("html,body").addClass("chat-mobile-open");$("body").css("height",n+"px");w.css("height",l+"px");i.css("height",f+"px");Nt("main_chat_visibility")}else{$("html,body").removeClass("chat-mobile-open");$("body").removeAttr("style");w.add(i).removeAttr("style");if(t<768){Nt("main_chat_visibility")}}N=t;C=n;ht()}function ht(){var e=additionalClients.find(".chat-window");if(N<768){var t=e.first();var n=t.find(".chat-header");var r=t.find(".chat-body");var s=t.find(".chat-footer");var o=i.height()-2;t.css("visibility","hidden").addClass("open");var u=n.outerHeight();var a=s.outerHeight();var f=o-(u+a);t.removeClass("open").attr("style","display:none;");e.css("height",o+"px");e.find(".chat-body").css("height",f+"px")}else{e.removeAttr("style").filter(".open").show();e.find(".chat-body").removeAttr("style")}}function gt(){var e=n;var t=i;var n=o.find(".channel-client-list").filter(":visible").length;if(n<1){pt=setTimeout(function(){if(!o.find(".channel-client-list").filter(":visible").length){c.find(".status-icon").html('<i class="icon-group"></i>');c.find(".status").html("There are currently no customers online.");c.fadeIn()}},8e3)}else{clearTimeout(pt);c.hide()}var i=u.find(".channel-client-list").filter(":visible").length;if(i<1){dt=setTimeout(function(){if(!u.find(".channel-client-list").filter(":visible").length){h.find(".status-icon").html('<i class="icon-group"></i>');h.find(".status").html("There are currently no employees online.");h.fadeIn()}},8e3)}else{clearTimeout(dt);h.hide()}var s=f.filter(".customers").hasClass("active");var a=s?n:i;var l=s?e:t;var p=$(".main-chat-notice-online-num");p.text(a+" Online");if(a>l&&r.hasClass("chat-minimized"))p.addClass("blink-me");else p.removeClass("blink-me")}function yt(){var e=i.find(".channel-client-list");e.each(function(){var e=$(this);var t=e.attr("data-channelid");var n=Tt(t+"-cookie");var r=additionalClients.find("#"+t).find(".chat-message");var i=e.find(".chat-indicator");if(n==null&&r.filter(".flash").length){r.removeClass("flash");i.html('<i class="icon-chevron-right"></i>').removeClass("blink-me");kt()}})}function wt(){var e=k==1?k+" Unread Message!":k+" Unread Messages!";var t=S.attr("data-title");if(S.text()==t)S.text(e);else S.text(t);yt();Et("on")}function Et(e){clearTimeout(bt);if(e=="off"||k<1){S.text(S.attr("data-title"));return}bt=setTimeout(wt,1e3)}function St(){b.removeClass("icon-chevron-up icon-chevron-down");if(r.hasClass("chat-minimized")){b.addClass("icon-chevron-up")}else{b.addClass("icon-chevron-down")}}function xt(e,t,n){if(n){var r=new Date;r.setTime(r.getTime()+n*24*60*60*1e3);var i="; expires="+r.toGMTString()}else var i="";document.cookie=e+"="+t+i+"; path=/"}function Tt(e){var t=e+"=";var n=document.cookie.split(";");for(var r=0;r<n.length;r++){var i=n[r];while(i.charAt(0)==" ")i=i.substring(1,i.length);if(i.indexOf(t)==0)return i.substring(t.length,i.length)}return null}function Nt(e){xt(e,"",-1)}function kt(){var e=i.find(".channel-client-list");if(Ct){e.each(function(){var e=$(this);var t=e.attr("data-channelid");var n=parseInt(Tt(t+"-cookie"));var r=additionalClients.find("#"+t);if(n>0){e.find(".chat-indicator").html(n).addClass("blink-me");var i=-1*n;r.find(".chat-message").slice(i).addClass("flash")}});Ct=false}else{e.each(function(){var e=$(this);var t=e.attr("data-channelid");var n=additionalClients.find("#"+t);var r=n.find(".chat-message.flash").length;var i=e.find(".chat-indicator");if(r>0&&!i.hasClass("active")){i.html(r).addClass("blink-me");xt(t+"-cookie",r,1)}else{i.html('<i class="icon-chevron-right"></i>').removeClass("blink-me");Nt(t+"-cookie")}})}var t=r.find(".chat-indicator.blink-me");var n=0;if(t.length){t.each(function(){n+=parseInt($(this).text())})}k=n;if(n>0){T.text(n).addClass("blink-me");Et("on");x.fadeIn();var s=f.not(".active");var o=f.index(s);var u=a.eq(o).find(".chat-indicator").filter(".blink-me").length;if(u>0){s.addClass("blink-me")}else{s.removeClass("blink-me")}}else{Et("off");x.fadeOut()}}var e=$("#gae-chat-variables");if(!e.length){return}sendMessageURL=$("#send_message_url").attr("data-url");getTokenURL=$("#get_token_url").attr("data-url");onlineTestURL=$("#online_test_url").attr("data-url");onlineCheckURL=$("#send_online_check_url").attr("data-url");pingAllCustomersURL=$("#ping_all_customers_url").attr("data-url");refreshOnlineUsersURL=$("#refresh_online_users_url").attr("data-url");getMessagesURL=$("#get_customer_messages_url").attr("data-url");getUsersPlusMessagesURL=$("#get_users_and_messages_url").attr("data-url");minMainChatBtn=$("#min-main-chat-btn");additionalClients=$("#additional_clients");displayNotifications=false;disconnect_timeouts={};customer_chat_histories={};connectedToChannel=false;connected_clients={};extra_clients={};chatHistory={};needToRestartChannels=false;var t=$("#chat_customer_pic").attr("data-url");var n=$("#chat_employee_pic").attr("data-url");var r=$("#main-chat-window");var i=$("#main-chat-body");var s=$("#main-chat-header");var o=$("#customer-chat-clients");var u=$("#employee-chat-clients");var a=$(".chat-titles");var f=s.find(".chat-group");var l=s.find(".chat-settings");var c=o.find(".no-customers");var h=u.find(".no-employees");var p=s.find(".chat-nav");var d=$("#main-chat-footer");var v=$("#main-chat-notice");var m=$("#chat-send-message-btn");var g=$("#chat-btn-input");var y=$(".main-chat-notice-toggle");var b=y.find("i");var w=r.find(".chat-container");var E=v.find(".chat-status");var S=$("title");var x=v.find(".main-chat-notice-messages");var T=v.find(".main-chat-notice-num-messages");var N=0;var C=0;var k=0;var L=$(window).width();String.prototype.capitalize=function(){return this.replace(/(?:^|\s)\S/g,function(e){return e.toUpperCase()})};var pt=null;var dt=null;var vt=0;var mt=0;var bt=null;var Ct=true;additionalClients.on("keyup",".chat-input-box",function(e){if(e.which==13){var t=$(this).attr("data-channelid");var n=$(this).val();if(n){G(n,t);$(this).val("")}}});additionalClients.on("click",".chat-button",function(e){var t=$(this).attr("data-channelid");var n="#"+t+"-btn-input";var r=$(n).val();if(r){G(r,t);$(n).val("")}});i.on("click",".channel-client-list",function(){var e=$(this);var t=e.attr("data-channelid");var n=e.find(".chat-client-div-info.badge").text();var r=e.find(".last-page-url > a").text();if(!$("#"+t).length){lt(t);openClients.push(t)}var s=i.find(".chat-indicator");var o=e.find(".chat-indicator");s.removeClass("active");o.addClass("active").removeClass("blink-me").html('<i class="icon-chevron-right"></i>');kt();q(t,n,r)});minMainChatBtn.click(function(){if(i.hasClass("chat-minimized")){i.removeClass("chat-minimized").show();$(this).html('<i class="icon-chevron-down"></i>');localStorage.setItem("chatminimized","no")}else{i.addClass("chat-minimized").hide();$(this).html('<i class="icon-chevron-up"></i>');localStorage.setItem("chatminimized","yes")}});additionalClients.on("click",".min-max-btn",function(){var e="#"+$(this).attr("data-channelid")+"-chat-body";if($(e).hasClass("chat-minimized")){$(e).show();$(this).parent().parent().removeClass("chat-minimized");$(e).removeClass("chat-minimized");$(this).html("<i class='icon-chevron-down'></i>")}else{$(e).hide();$(this).parent().parent().addClass("chat-minimized");$(e).addClass("chat-minimized");$(this).html("<i class='icon-chevron-up'></i>")}});additionalClients.on("click",".close-chat-btn",function(e){I()});additionalClients.on("click",".chat-header",function(e){if(e.target!=this){return}});s.on("click",function(e){if(e.target!=this){return}if(i.hasClass("chat-minimized")){minMainChatBtn.html('<i class="icon-chevron-down"></i>');i.removeClass("chat-minimized").show();localStorage.setItem("chatminimized","no")}});additionalClients.on("click",".do-online-check",function(){var e=i.find(".chat-indicator.active");i.animate({scrollTop:e.offset().top},300);var t=$(this).attr("data-channelid");W(t)});$("#enableNotifications").click(function(e){if(e.target!=this){return}if(Notification.permission!=="denied"){Notification.requestPermission(function(e){if(!("permission"in Notification)){Notification.permission=e}})}});$("#ping_all_customers").click(function(e){if(e.target!=this){return}tt()});$("#refresh_online_users_list").click(function(e){if(e.target!=this){return}rt()});l.click(function(){I()});f.click(function(){I();var e=$(this);var t=$(".online-group-icon");if(e.hasClass("customers")){o.removeClass("hide");u.addClass("hide");t.html('<i class="icon-group"></i>')}else{o.addClass("hide");u.removeClass("hide");t.html('<i class="icon-briefcase"></i>')}f.removeClass("active");e.addClass("active").removeClass("blink-me");kt();gt();setTimeout(function(){rt()},15e3)});p.click(function(){if(p.hasClass("toggle")){v.click()}});v.on("click",function(e){I();if(y.hasClass("offline")||y.hasClass("checking"))return;if(r.hasClass("chat-minimized")){r.attr("data-offset",window.pageYOffset);$("html,body").animate({scrollTop:0},100);r.removeClass("chat-minimized");y.html("<i class='icon-chevron-down'></i>");xt("main_chat_visibility","open",2)}else{if(N<768){$("html,body").animate({scrollTop:parseInt(r.attr("data-offset"))},400)}r.addClass("chat-minimized");y.html("<i class='icon-chevron-up'></i>");xt("main_chat_visibility","closed",2)}ct(false)});$(window).resize(function(){if(additionalClients.find(".chat-input-box").is(":focused")){return}ct(true)}).resize();var Lt=Tt("main_chat_visibility");S.attr("data-title",S.text());$.timeago.settings.strings.seconds="seconds";$("abbr.timeago").timeago();Y()})