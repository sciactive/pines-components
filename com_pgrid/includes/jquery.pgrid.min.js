/*
 * jQuery Pines Grid (pgrid) Plugin 1.2.0dev
 *
 * http://pinesframework.org/pgrid/
 * Copyright (c) 2009-2012 Hunter Perrin
 *
 * Triple license under the GPL, LGPL, and MPL:
 *	  http://www.gnu.org/licenses/gpl.html
 *	  http://www.gnu.org/licenses/lgpl.html
 *	  http://www.mozilla.org/MPL/MPL-1.1.html
 */
(function(e){e.fn.pgrid_add=function(t,n){if(!t)return this;this.each(function(){if(!this.pines_grid)return;var r=this.pines_grid;var i="";e.each(t,function(){var e=this;i+="<tr"+(typeof e.key!="undefined"?' title="'+String(e.key)+'"':"")+(typeof e.classes!="undefined"?' class="'+String(e.classes)+'"':"")+">";i+="<td>"+e.values.join("</td><td>")+"</td></tr>"});var s=r.children("tbody").detach();var o=e(i).appendTo(s);r.init_rows(o);r.do_col_hiding(true,o);r.do_sort(false,true,s);r.do_filter(false,true,s);r.append(s);r.paginate(true);r.update_selected();if(n)o.each(n);r.trigger("rows_added.pgrid")});return this};e.fn.pgrid_delete=function(t){if(t){this.each(function(){var n=this.pines_grid;if(!n)return;if(t.jquery)t.each(function(){n.mark_for_delete_recursively(e(this))});else e.each(t,function(){var t=this;if(typeof t=="object"){n.mark_for_delete_recursively(e(this))}else{n.children("tbody").children("[title="+t+"]").each(function(){n.mark_for_delete_recursively(e(this))})}});n.delete_marked()})}else{var n=this.closest("table.ui-pgrid-table").get(0);if(n)n=n.pines_grid;if(!n)return this;this.each(function(){n.mark_for_delete_recursively(e(this))});n.delete_marked()}return this};e.fn.pgrid_export_rows=function(t){var n=[];if(!t)t=this;e.each(t,function(){var t=e(this);var r=t.attr("title");var i=t.attr("class");var s=[];t.children().not(".ui-pgrid-table-expander").each(function(){s=e.merge(s,[e(this).text()])});n=e.merge(n,[{key:typeof r=="undefined"?"":r,classes:typeof i=="undefined"?"":i.replace(/\bui-[a-z0-9 \-]+/,""),values:s}])});return n};e.fn.pgrid_expand_rows=function(e){var t=null;if(!e){e=this;t=e.closest(".ui-pgrid-table").get(0);if(t&&t.pines_grid)t=t.pines_grid}else{t=this.get(0);if(t&&t.pines_grid)t=t.pines_grid}if(!t)return this;if(!e.jquery){if(typeof e!="object")return this;e=t.children("tbody").children("[title='"+e.join("'], [title='")+"']")}var n=e.filter(".parent").addClass("ui-pgrid-table-row-expanded");t.show_children(n);return this};e.fn.pgrid_collapse_rows=function(e){var t=null;if(!e){e=this;t=e.closest(".ui-pgrid-table").get(0);if(t&&t.pines_grid)t=t.pines_grid}else{t=this.get(0);if(t&&t.pines_grid)t=t.pines_grid}if(!t)return this;if(!e.jquery){if(typeof e!="object")return this;e=t.children("tbody").children("[title='"+e.join("'], [title='")+"']")}var n=e.filter(".parent").removeClass("ui-pgrid-table-row-expanded");t.hide_children(n);return this};e.fn.pgrid_select_rows=function(e){var t=null;if(!e){e=this;t=e.closest(".ui-pgrid-table").get(0);if(t&&t.pines_grid)t=t.pines_grid}else{t=this.get(0);if(t&&t.pines_grid)t=t.pines_grid}if(!t)return this;if(!e.jquery){if(typeof e!="object")return this;e=t.children("tbody").children("[title='"+e.join("'], [title='")+"']")}if(t.pgrid_select){if((t.children("tbody").children(".ui-pgrid-table-row-selected").length||e.length>1)&&!t.pgrid_multi_select)return this;e.addClass("ui-pgrid-table-row-selected ui-state-active");t.update_selected()}return this};e.fn.pgrid_deselect_rows=function(e){var t=null;if(!e){e=this;t=e.closest("table.ui-pgrid-table").get(0);if(t&&t.pines_grid)t=t.pines_grid}else{t=this.get(0);if(t&&t.pines_grid)t=t.pines_grid}if(!t)return this;if(!e.jquery){if(typeof e!="object")return this;e=t.children("tbody").children("[title='"+e.join("'], [title='")+"']")}if(t.pgrid_select){e.removeClass("ui-pgrid-table-row-selected ui-state-active");t.update_selected()}return this};e.fn.pgrid_get_all_rows=function(){var e=false;this.each(function(){if(!this.pines_grid.jquery)return;var t=this.pines_grid;if(e)e=e.add(t.children("tbody").children());else e=t.children("tbody").children()});return e};e.fn.pgrid_get_selected_rows=function(){var e=false;this.each(function(){if(!this.pines_grid.jquery)return;var t=this.pines_grid;if(e)e=e.add(t.children("tbody").children(".ui-pgrid-table-row-selected"));else e=t.children("tbody").children(".ui-pgrid-table-row-selected")});return e};e.fn.pgrid_add_descendant_rows=function(){var t=e(this);var n=null;n=t.closest("table.ui-pgrid-table").get(0);if(n&&n.pines_grid)n=n.pines_grid;if(!n)return this;this.filter(".parent").each(function(){var r=e(this);var i=r.siblings("."+n.pgrid_child_prefix+r.attr("title"));t=t.add(i.pgrid_add_descendant_rows())});return t};e.fn.pgrid_get_value=function(t){var n=e(this).eq(0);return n.children(":nth-child("+(t+1)+")").html()};e.fn.pgrid_set_value=function(e,t){this.children(":nth-child("+(e+1)+")").html(t)};e.fn.pgrid_export_state=function(){var e=this.get(0);if(e&&e.pines_grid)e=e.pines_grid;if(e.jquery)return e.export_state();return false};e.fn.pgrid_import_state=function(e){this.each(function(){if(!this.pines_grid)return;this.pines_grid.import_state(e)});return this};e.fn.pgrid_add_toolbar_item=function(e){var t=this.get(0);if(!e)return this;if(!t.pines_grid)return this;t=t.pines_grid;if(!t.pgrid_toolbar)return this;var n=t.closest(".ui-pgrid").find(".ui-pgrid-toolbar");n.append(e);e.fadeIn(parseInt(e.attr("data-show")));e.trigger("toolbar_item_added.pgrid");return this};e.fn.pgrid=function(n){var r=e.extend({},e.fn.pgrid.defaults,n);this.filter("table").not(".ui-pgrid-table").each(function(){var n=e(this);n.pgrid_version="1.2.0dev";n.extend(n,r);n.pgrid_pages=null;n.pgrid_widget=e("<div />");n.pgrid_table_container=e("<div />");n.pgrid_header_select=e("<div />");n.wrapAll(n.pgrid_widget);n.pgrid_widget=n.parent();n.detach();n.pgrid_widget.addClass("ui-pgrid ui-widget ui-widget-content ui-corner-all");n.pgrid_table_container.addClass("ui-pgrid-table-container");n.pgrid_table_container.append(n);n.addClass("ui-pgrid-table");if(n.pgrid_select)n.addClass("ui-pgrid-selectable");n.pgrid_toolbar_contents=n.pgrid_toolbar_contents.slice();n.pgrid_hidden_cols=n.pgrid_hidden_cols.slice();if(!n.pgrid_hidden_cols.indexOf){n.pgrid_hidden_cols.indexOf=function(e){var t=this.length>>>0;var n=Number(arguments[1])||0;n=n<0?Math.ceil(n):Math.floor(n);if(n<0)n+=t;for(;n<t;n++){if(n in this&&this[n]===e)return n}return-1}}n.export_state=function(){var e={pgrid_page:n.pgrid_page,pgrid_perpage:n.pgrid_perpage,pgrid_filter:n.pgrid_filter,pgrid_hidden_cols:n.pgrid_hidden_cols.slice(),pgrid_sort_col:n.pgrid_sort_col,pgrid_sort_ord:n.pgrid_sort_ord};if(n.pgrid_stateful_height)e.pgrid_view_height=n.pgrid_table_viewport.css("height");return e};n.import_state=function(e){if(typeof e.pgrid_page=="number")n.pgrid_page=e.pgrid_page;if(typeof e.pgrid_perpage=="number")n.pgrid_perpage=e.pgrid_perpage;if(typeof e.pgrid_filter=="string")n.pgrid_filter=e.pgrid_filter;if(typeof e.pgrid_hidden_cols=="object")n.pgrid_hidden_cols=e.pgrid_hidden_cols.slice(0);if(typeof e.pgrid_sort_col=="number")n.pgrid_sort_col=e.pgrid_sort_col;if(typeof e.pgrid_sort_ord=="string")n.pgrid_sort_ord=e.pgrid_sort_ord!="desc"?"asc":"desc";if(n.pgrid_stateful_height&&typeof e.pgrid_view_height=="string")n.pgrid_table_viewport.css("height",e.pgrid_view_height);n.do_filter(n.pgrid_filter);n.do_sort();n.do_col_hiding();if(n.pgrid_footer&&n.pgrid_filtering)n.footer.children(".ui-pgrid-footer-filter-container").find("input.ui-pgrid-footer-filter-input").val(n.pgrid_filter);if(n.pgrid_footer&&n.pgrid_paginate)n.footer.children(".ui-pgrid-footer-pager-container").find("input.ui-pgrid-per-page").val(n.pgrid_perpage)};n.state_changed=function(){if(n.pgrid_state_change)return n.pgrid_state_change(n.export_state());return null};n.pagestart=function(){n.pgrid_page=0;n.paginate()};n.pageprev=function(){n.pgrid_page--;if(n.pgrid_page<0)n.pgrid_page=0;n.paginate()};n.pagenext=function(){n.pgrid_page++;if(n.pgrid_page>=n.pgrid_pages)n.pgrid_page=n.pgrid_pages-1;n.paginate()};n.pageend=function(){n.pgrid_page=n.pgrid_pages-1;n.paginate()};n.pagenum=function(e){n.pgrid_page=e;if(isNaN(n.pgrid_page)||n.pgrid_page<0)n.pgrid_page=0;else if(n.pgrid_page>=n.pgrid_pages)n.pgrid_page=n.pgrid_pages-1;n.paginate()};n.set_per_page=function(e){n.pgrid_page=0;n.pgrid_perpage=e;if(n.pgrid_perpage===0)n.pgrid_perpage=1;n.paginate()};n.hide_children=function(t){var r=t.filter(".parent");if(!r.length)return;r.children(".ui-pgrid-table-expander").children(".ui-icon").removeClass("ui-icon-triangle-1-s").addClass("ui-icon-triangle-1-e");r.each(function(){var t=e(this);t.siblings("tr."+n.pgrid_child_prefix+t.attr("title")+".ui-pgrid-table-row-visible").removeClass("ui-pgrid-table-row-visible").filter(".parent").each(function(){n.hide_children(e(this))})})};n.show_children=function(t){var r=t.filter(".parent.ui-pgrid-table-row-expanded");if(!r.length)return;r.children(".ui-pgrid-table-expander").children(".ui-icon").removeClass("ui-icon-triangle-1-e").addClass("ui-icon-triangle-1-s");r.each(function(){var t=e(this);t.siblings("tr."+n.pgrid_child_prefix+t.attr("title")).addClass("ui-pgrid-table-row-visible").filter(".parent.ui-pgrid-table-row-expanded").each(function(){n.show_children(e(this))})})};n.place_children=function(t){var r=t.filter(".parent");if(!r.length)return;r.each(function(){var t=e(this);var r=t.siblings("."+n.pgrid_child_prefix+t.attr("title"));t.after(r);n.place_children(r.filter(".parent"))})};n.mark_for_delete_recursively=function(t){t.each(function(){var t=e(this);var r=t.attr("title");if(typeof r!="undefined"&&r!=""){t.siblings("."+n.pgrid_child_prefix+r).each(function(){var t=e(this);if(t.hasClass("parent"))n.mark_for_delete_recursively(t);else t.addClass("ui-pgrid-table-row-marked-for-deletion")})}t.addClass("ui-pgrid-table-row-marked-for-deletion")})};n.delete_marked=function(){n.children("tbody").children(".ui-pgrid-table-row-marked-for-deletion").remove();n.do_sort(false,true);n.do_filter(false,true);n.paginate(true);n.update_selected()};n.paginate=function(t){if(n.pgrid_paginate){var r=n.children("tbody").children().not(".ui-helper-hidden, .child");if(isNaN(n.pgrid_perpage)||n.pgrid_perpage<1)n.pgrid_perpage=e.fn.pgrid.defaults.pgrid_perpage;n.pgrid_pages=Math.ceil(r.length/n.pgrid_perpage);if(n.pgrid_page+1>n.pgrid_pages)n.pgrid_page=n.pgrid_pages-1;else if(n.pgrid_page==-1&&n.pgrid_pages>0)n.pgrid_page=0;if(n.cur_page_rows)n.hide_children(n.cur_page_rows.removeClass("ui-pgrid-table-row-visible"));var i=n.pgrid_page*n.pgrid_perpage;var s=n.pgrid_page*n.pgrid_perpage+n.pgrid_perpage;n.cur_page_rows=r.slice(i,s);n.cur_page_rows.addClass("ui-pgrid-table-row-visible");n.show_children(n.cur_page_rows);if(n.pgrid_footer){if(!n.page_number_elem)n.page_number_elem=n.footer.find("input.ui-pgrid-page-number");n.page_number_elem.val(n.pgrid_page+1);if(!n.page_total_elem)n.page_total_elem=n.footer.find("span.ui-pgrid-page-total");n.page_total_elem.html(n.pgrid_pages)}}if(!t)n.state_changed()};n.paginate_queue=function(){if(n.paginate_timout)window.clearTimeout(n.paginate_timout);n.paginate_timout=window.setTimeout(n.paginate,50)};n.animate_filter=function(e){if(e)n.footer_input.stop(true).fadeTo(400,1);else n.footer_input.fadeTo(1e3,.7).fadeTo(1e3,.8,n.animate_filter)};n.do_filter=function(e,t,r){if(n.pgrid_filtering||t){if(n.footer_input){n.footer_input.addClass("ui-state-highlight");n.animate_filter()}if(n.filter_timer)window.clearInterval(n.filter_timer);if(typeof e=="string")n.pgrid_filter=e;if(n.pgrid_filter.length>0){var i=n.pgrid_filter.toLowerCase().split(" ");var s=0;if(!r)r=n.children("tbody");var o=r.children();n.filter_timer=window.setInterval(function(){var e,r,u,a;do{e=o.eq(s);if(!e.length){window.clearInterval(n.filter_timer);if(n.footer_input){n.footer_input.removeClass("ui-state-highlight");n.animate_filter(true)}break}s++;r=e.get();if(r.pgrid_filter_text){u=r.pgrid_filter_text}else{if(r.innerText!=undefined)u=r.innerText.toLowerCase();else if(r.textContent!=undefined)u=r.textContent.toLowerCase();else u=e.text().toLowerCase();r.pgrid_filter_text=u}var f=true;for(a in i){if(u.indexOf(i[a])==-1){f=false;break}}if(e.hasClass("ui-helper-hidden")){if(f)e.removeClass("ui-helper-hidden")}else{if(!f)e.addClass("ui-helper-hidden")}if(f&&e.hasClass("child"))n.enable_parents(e)}while(s%25);if(!t){n.paginate_queue();n.update_selected_queue()}},1)}else{n.children("tbody").children(".ui-helper-hidden").removeClass("ui-helper-hidden");if(n.footer_input){n.footer_input.removeClass("ui-state-highlight");n.animate_filter(true)}if(!t){n.paginate();n.update_selected()}}}};n.enable_parents=function(t){t.filter(".child").each(function(){var t=e(this);t.siblings("tr.parent").each(function(){var r=e(this);if(t.hasClass(n.pgrid_child_prefix+r.attr("title"))){r.removeClass("ui-helper-hidden");n.enable_parents(r)}})})};n.do_sort=function(t,r,i){if(n.pgrid_sortable){if(t){if(typeof t=="string")t=t.replace(/\D/g,"");t=parseInt(t)}if(!r){if(n.pgrid_sort_col==t){if(n.pgrid_sort_ord=="asc")n.pgrid_sort_ord="desc";else n.pgrid_sort_ord="asc"}else{if(t){n.pgrid_sort_col=t;n.pgrid_sort_ord="asc"}}}var s=n.children("thead").children().children();s.children(".ui-pgrid-table-header-sorted-asc, .ui-pgrid-table-header-sorted-desc").removeClass("ui-pgrid-table-header-sorted-asc ui-pgrid-table-header-sorted-desc ui-icon-triangle-1-s ui-icon-triangle-1-n");if(n.pgrid_sort_ord=="asc")s.filter(":nth-child("+(n.pgrid_sort_col+1)+")").children(".ui-icon").addClass("ui-pgrid-table-header-sorted-desc ui-icon-triangle-1-n");else s.filter(":nth-child("+(n.pgrid_sort_col+1)+")").children(".ui-icon").addClass("ui-pgrid-table-header-sorted-asc ui-icon-triangle-1-s");var o=false;if(!i){i=n.children("tbody").detach();o=true}var u=i.children();u.children(".ui-pgrid-table-cell-sorted").removeClass("ui-pgrid-table-cell-sorted");u.children(":nth-child("+(n.pgrid_sort_col+1)+")").addClass("ui-pgrid-table-cell-sorted");var a=u.get();e.each(a,function(){var t=this.children[n.pgrid_sort_col];if(typeof t=="undefined")return;var r;if(t.innerText!=undefined)r=t.innerText.toLowerCase();else if(t.textContent!=undefined)r=t.textContent.toLowerCase();else r=e(t).text().toLowerCase();this.sortKey=[];var i=0,s=-1,o=0,u,a;while(u=(a=r.charAt(i++)).charCodeAt(0)){var f=u==46||u>=48&&u<=57;if(f!==o){this.sortKey[++s]="";o=f}this.sortKey[s]+=a}});a.sort(function(e,t){var n=e.sortKey,r=t.sortKey;for(var i=0,s,o;(s=n[i])&&(o=r[i]);i++){if(s!==o){var u=Number(s),a=Number(o);if(u==s&&a==o)return u-a;else return s>o?1:-1}}return n.length-r.length});if(n.pgrid_sort_ord=="desc")a.reverse();var f=e(a);i.append(f);n.place_children(f.filter(".parent").not(".child"));if(o)n.append(i);if(!r)n.paginate()}};n.update_selected=function(){if(n.pgrid_select){n.children("tbody").children(".ui-helper-hidden.ui-pgrid-table-row-selected").removeClass("ui-pgrid-table-row-selected ui-state-active");if(n.pgrid_footer&&n.pgrid_count)n.footer.children(".ui-pgrid-footer-count-container").find("span.ui-pgrid-footer-count-select").html(n.children("tbody").children(".ui-pgrid-table-row-selected").length)}n.update_count()};n.update_selected_queue=function(){if(n.update_selected_timout)window.clearTimeout(n.update_selected_timout);n.update_selected_timout=window.setTimeout(n.update_selected,200)};n.update_count=function(){if(n.pgrid_footer&&n.pgrid_count)n.footer.children(".ui-pgrid-footer-count-container").find("span.ui-pgrid-footer-count-total").html(n.children("tbody").children().not(".ui-helper-hidden").length)};n.do_col_hiding=function(t,r){var i=n.children("thead").children();if(!r)r=n.children("tbody").children();if(!t){i.children(":hidden").each(function(){var t=e(this).show();r.children(":nth-child("+(t.prevAll().length+1)+")").show()})}var s=n.pgrid_header_select.children().children();s.attr("checked",true);for(var o in n.pgrid_hidden_cols){if(isNaN(o))continue;s.filter(".ui-pgrid-table-col-hider-"+n.pgrid_hidden_cols[o]).removeAttr("checked");i.children(":nth-child("+(n.pgrid_hidden_cols[o]+1)+")").hide();r.children(":nth-child("+(n.pgrid_hidden_cols[o]+1)+")").hide()}if(!t)n.state_changed()};n.hide_col=function(e){if(n.pgrid_hidden_cols.indexOf(e)==-1){n.pgrid_hidden_cols.push(e);n.pgrid_header_select.children().children(".ui-pgrid-table-col-hider-"+e).removeAttr("checked");n.children("thead").children().children(":nth-child("+(e+1)+")").hide();n.children("tbody").children().children(":nth-child("+(e+1)+")").hide();n.state_changed()}};n.show_col=function(e){if(n.pgrid_hidden_cols.indexOf(e)!=-1){n.pgrid_hidden_cols.splice(n.pgrid_hidden_cols.indexOf(e),1);n.pgrid_header_select.children().children(".ui-pgrid-table-col-hider-"+e).attr("checked",true);n.children("thead").children().children(":nth-child("+(e+1)+")").show();n.children("tbody").children().children(":nth-child("+(e+1)+")").show();n.state_changed()}};n.init_rows=function(e){if(!e)return;e.addClass("ui-state-default").prepend('<td class="ui-pgrid-table-expander"></td>');n.init_children(e.filter(".parent").not(".child"))};n.init_children=function(t){if(!t.length)return;t.each(function(){var t=e(this);var r=parseInt(t.children(":last-child").css("padding-left"));if(isNaN(r))r=0;n.init_children(t.siblings("."+n.pgrid_child_prefix+t.attr("title")).each(function(){e(this).children().not(".ui-pgrid-table-expander").css("padding-left",r+10+"px")}).filter(".parent"))}).children(".ui-pgrid-table-expander").append(e("<span />").addClass("ui-icon ui-icon-triangle-1-e"))};n.children("tbody").delegate("tr.parent td.ui-pgrid-table-expander","click",function(){var t=e(this).parent();if(t.hasClass("ui-pgrid-table-row-expanded")){t.removeClass("ui-pgrid-table-row-expanded");n.hide_children(t)}else{t.addClass("ui-pgrid-table-row-expanded");n.show_children(t)}});if(n.pgrid_row_hover_effect){n.children("tbody").delegate("tr","mouseover",function(){e(this).addClass("ui-state-hover")}).delegate("tr","mouseout",function(){e(this).removeClass("ui-state-hover")})}if(n.pgrid_select){n.children("tbody").delegate("tr","click",function(t){if(e(t.target).parent().andSelf().hasClass("ui-pgrid-table-expander"))return;var r=e(this);if(!n.pgrid_multi_select||!t.ctrlKey&&!t.shiftKey)r.siblings().removeClass("ui-pgrid-table-row-selected ui-state-active");else if(t.shiftKey)r.prevUntil(".ui-pgrid-table-row-selected").addClass("ui-pgrid-table-row-selected ui-state-active");if(t.ctrlKey)r.toggleClass("ui-pgrid-table-row-selected").toggleClass("ui-state-active");else r.addClass("ui-pgrid-table-row-selected ui-state-active");n.update_selected();if(n.pgrid_click)n.pgrid_click(t,n.children("tbody").children(".ui-pgrid-table-row-selected"))}).delegate("tr","dblclick",function(t){if(e(t.target).hasClass("ui-pgrid-table-expander"))return;e(this).addClass("ui-pgrid-table-row-selected ui-state-active");if(n.pgrid_double_click)n.pgrid_double_click(t,n.children("tbody").children(".ui-pgrid-table-row-selected"));if(n.pgrid_double_click_tb)n.pgrid_double_click_tb()}).delegate("tr","mousedown",function(e){return!(e.ctrlKey||e.shiftKey)})}n.h_rows=n.children("thead").children();n.h_rows.children().each(function(t){var r=e(this);n.pgrid_header_select.append(e("<label></label>").addClass("ui-state-default ui-corner-all").append(e('<input type="checkbox" />').change(function(e){if(e.target.checked)n.show_col(t+1);else n.hide_col(t+1)}).addClass("ui-pgrid-table-col-hider-"+(t+1))).append(r.text()))});n.pgrid_header_select.addClass("ui-pgrid-header-select ui-widget-header ui-corner-all");n.pgrid_header_select.mouseenter(function(){e(this).mouseleave(function(){e(this).fadeOut("fast").unbind("mouseleave")})});n.resizing_header=false;n.resizing_tempX=0;var i=e("<div />").addClass("ui-pgrid-table-header-text");if(n.pgrid_sortable)i.addClass("ui-pgrid-table-header-sortable");n.h_headers=n.h_rows.children().not(".ui-pgrid-table-expander").mouseup(function(){if(n.resizing_header)n.resizing_header=false;else n.do_sort(e(this).prevAll().length)}).wrapInner(i).append(e("<span />").addClass("ui-icon"));if(n.pgrid_resize_cols){n.h_headers.addClass("ui-pgrid-table-header-resizeable").mousedown(function(t){var r=e(this);var i=t.pageX-r.offset().left;if(i<4&&r.hasClass("ui-pgrid-table-expander")||i>3&&i<r.width()-4)return true;n.resizing_header=true;n.resizing_tempX=t.pageX;if(i<4)n.resizing_cur=r.prev().children(".ui-pgrid-table-header-text");else n.resizing_cur=r.children(".ui-pgrid-table-header-text");return false})}delete n.h_headers;if(n.pgrid_resize_cols){n.pgrid_widget.mousemove(function(e){if(n.resizing_header){var t=n.resizing_cur.width();var r=t+e.pageX-n.resizing_tempX;if(r>0){n.resizing_tempX=e.pageX;n.resizing_cur.width(r)}}}).mouseup(function(){n.resizing_header=false})}n.h_rows.addClass("ui-widget-header").prepend(e('<th class="ui-icon ui-pgrid-table-icon-hidden ui-pgrid-table-expander"><div style="width: 16px; visibility: hidden;">+</div></th>').click(function(e){var t=n.pgrid_widget.offset();n.pgrid_header_select.css({left:e.pageX-t.left-5,top:e.pageY-t.top-5});n.pgrid_header_select.fadeIn("fast")}).mouseover(function(){e(this).removeClass("ui-pgrid-table-icon-hidden").addClass("ui-icon-triangle-1-s")}).mouseout(function(){e(this).addClass("ui-pgrid-table-icon-hidden").removeClass("ui-icon-triangle-1-s")}));delete n.h_rows;n.init_rows(n.children("tbody").children());n.do_col_hiding(true);n.pgrid_table_viewport=e('<div class="ui-pgrid-table-viewport ui-widget-content" />');n.pgrid_table_container.appendTo(n.pgrid_table_viewport);n.pgrid_table_viewport.height(n.pgrid_view_height);if(n.pgrid_view_height!="auto"){n.pgrid_table_container.css({position:"absolute",top:"0",bottom:"0",left:"0",right:"0"})}if(n.pgrid_toolbar){n.toolbar=e("<div />").addClass("ui-pgrid-toolbar").delegate("button","focus",function(){e(this).addClass("ui-state-focus")}).delegate("button","blur",function(){e(this).removeClass("ui-state-focus ui-state-active")}).delegate("button","mousedown",function(){e(this).addClass("ui-state-active")}).delegate("button","mouseup",function(){e(this).removeClass("ui-state-active")}).delegate("button","mouseenter",function(){e(this).addClass("ui-state-hover")}).delegate("button","mouseleave",function(){e(this).removeClass("ui-state-hover")});e.each(n.pgrid_toolbar_contents,function(r,i){if(i.type=="button"){var s=e('<button class="ui-pgrid-toolbar-button ui-state-default ui-corner-all" type="button" />').append(e(typeof i.text=="undefined"?"<span></span>":"<span>"+i.text+"</span>").each(function(){if(i.extra_class)e(this).addClass(i.extra_class)})).click(function(r){if(r.button==2)return true;var s=i.return_all_rows?n.children("tbody").children().not(".ui-helper-hidden"):n.children("tbody").children(".ui-pgrid-table-row-selected");if(!i.selection_optional&&!i.select_all&&!i.select_none&&s.length===0){alert("Please make a selection before performing this operation.");return false}if(!i.multi_select&&!i.selection_optional&&!i.select_all&&!i.select_none&&s.length>1){alert("Please choose only one item before performing this operation.");return false}if(i.confirm){if(typeof i.confirm=="function"){if(!i.confirm(r,s))return false}else{var o="";if(typeof i.text!="undefined"){o=' "'+i.text+'"'}else if(typeof i.title!="undefined"){o=' "'+i.title+'"'}if(i.return_all_rows){if(!confirm("Are you sure you want to perform the operation"+o+" on all items?"))return false}else if(s.length===0){if(!confirm("Are you sure you want to perform the operation"+o+"?"))return false}else{if(!confirm("Are you sure you want to perform the operation"+o+" on the "+s.length+" currently selected item(s)?"))return false}}}if(i.select_all){if(n.pgrid_select&&n.pgrid_multi_select){n.children("tbody").children().not(".ui-helper-hidden").addClass("ui-pgrid-table-row-selected ui-state-active");n.update_selected()}}if(i.select_none){if(n.pgrid_select){n.children("tbody").children().removeClass("ui-pgrid-table-row-selected ui-state-active");n.update_selected()}}if(i.click){var u="";if(i.pass_csv||i.pass_csv_with_headers){if(i.pass_csv_with_headers)s=n.children("thead").children().add(s);s.each(function(){e(this).children().not(".ui-pgrid-table-expander").each(function(){var t=e(this);u+='"'+t.contents().text().replace(/"/g,'""')+'"';if(t.next())u+=","});u+="\n"})}else{u=s}return i.click(r,u)}else if(i.url){var a=i.url;var f="";var l=[];s.each(function(){var n=e(this);var r=n.children().not(".ui-pgrid-table-expander");f+=(f.length?i.delimiter:"")+t(n.attr("title"));r.each(function(n){if(!l[n+1])l[n+1]=t(e(this).contents().text());else l[n+1]+=i.delimiter+t(e(this).contents().text())})});a=a.replace("__title__",f);for(var c in l){if(isNaN(c))continue;a=a.replace("__col_"+c+"__",l[c])}if(r.button==1||!i.target&&n.pgrid_toolbar_target!="_self"||i.target&&i.target!="_self"){var h=i.target?i.target:n.pgrid_toolbar_target;if(i.window_features)return window.open(a,h,i.window_features);return window.open(a,h)}else{if(typeof pines!="undefined"&&pines.get)return pines.get(a);return window.location=a}}return true});if(typeof i.title!="undefined")s.attr("title",i.title);if(i.double_click){if(n.pgrid_double_click_tb)var o=n.pgrid_double_click_tb;n.pgrid_double_click_tb=function(){if(o)o();s.click()}}n.toolbar.append(s)}else if(i.type=="text"){var u=e("<div />").addClass("ui-pgrid-toolbar-text");if(i.extra_class)u.addClass(i.extra_class);if(typeof i.title!="undefined")u.attr("title",i.title);if(i.label)u.append(e("<span>"+i.label+"</span>").addClass("ui-pgrid-toolbar-text-label"));var a=e('<input type="text" />').addClass("ui-widget ui-widget-content ui-corner-all");if(!i.dont_prevent_default){a.keydown(function(e){if(e.keyCode==13)e.preventDefault()})}if(i.attributes)a.attr(i.attributes);u.append(a);n.toolbar.append(u);if(i.load)i.load(a)}else if(i.type=="label"){var f=e("<div>"+i.label+"</div>").addClass("ui-pgrid-toolbar-label");if(i.extra_class)f.addClass(i.extra_class);if(typeof i.title!="undefined")f.attr("title",i.title);n.toolbar.append(f);if(i.load)i.load(f)}else if(i.type=="separator"){n.toolbar.append(e("<div />").addClass("ui-pgrid-toolbar-sep ui-state-default").append(e("<div>-</div>").addClass("ui-pgrid-toolbar-blank")))}})}if(n.pgrid_footer){n.footer=e("<div />").addClass("ui-pgrid-footer ui-widget-header ui-corner-bottom ui-helper-clearfix").delegate("button","focus",function(){e(this).addClass("ui-state-focus")}).delegate("button","blur",function(){e(this).removeClass("ui-state-focus ui-state-active")}).delegate("button","mousedown",function(){e(this).addClass("ui-state-active")}).delegate("button","mouseup",function(){e(this).removeClass("ui-state-active")}).delegate("button","mouseenter",function(){e(this).addClass("ui-state-hover")}).delegate("button","mouseleave",function(){e(this).removeClass("ui-state-hover")});if(n.pgrid_filtering){n.footer.append(e("<div />").addClass("ui-pgrid-footer-filter-container").each(function(){e(this).append(e("<span>Filter: </span>").append(e("<input />").addClass("ui-pgrid-footer-filter-input ui-widget ui-widget-content ui-corner-all").attr({type:"text",value:n.pgrid_filter,size:"10"}).keyup(function(){n.do_filter(e(this).val())})).append(e('<button type="button">X</button>').addClass("ui-state-default ui-corner-all").click(function(){e(this).prev("input").val("").keyup().focus()})))}));n.footer_input=n.footer.find("input.ui-pgrid-footer-filter-input")}}if(n.pgrid_filter!="")n.do_filter(n.pgrid_filter,true);if(n.pgrid_sort_col){if(typeof n.pgrid_sort_col=="string")n.pgrid_sort_col=n.pgrid_sort_col.replace(/\D/g,"");n.pgrid_sort_col=parseInt(n.pgrid_sort_col);if(n.pgrid_sort_ord!="desc")n.pgrid_sort_ord="asc";var s=n.pgrid_sortable;n.pgrid_sortable=true;n.do_sort(n.pgrid_sort_col,true);n.pgrid_sortable=s}if(n.pgrid_paginate){n.addClass("ui-pgrid-paginated");if(n.pgrid_footer){n.footer.append(e("<div />").addClass("ui-pgrid-footer-pager-container").each(function(){var t=e(this);t.append("Display ").append(e("<input />").addClass("ui-widget ui-widget-content ui-corner-all ui-pgrid-per-page").attr({type:"text",value:n.pgrid_perpage}).change(function(){var t=e(this);n.set_per_page(Math.abs(parseInt(t.val())));t.val(n.pgrid_perpage)})).append(" ").append(e('<button type="button">&lt;&lt; Start</button>').addClass("ui-state-default ui-corner-all").click(function(){n.pagestart()})).append(e('<button type="button">&lt; Prev</button>').addClass("ui-state-default ui-corner-all").click(function(){n.pageprev()})).append(" Page ").append(e("<input />").addClass("ui-widget ui-widget-content ui-corner-all ui-pgrid-page-number").attr({type:"text",value:n.pgrid_page,size:"3"}).change(function(){n.pagenum(Math.abs(parseInt(e(this).val()))-1)})).append(' of <span class="ui-pgrid-page-total">1</span> ').append(e('<button type="button">Next &gt;</button>').addClass("ui-state-default ui-corner-all").click(function(){n.pagenext()})).append(e('<button type="button">End &gt;&gt;</button>').addClass("ui-state-default ui-corner-all").click(function(){n.pageend()}))}))}n.paginate(true)}if(n.pgrid_footer){if(n.pgrid_count){n.footer.append(e("<div />").addClass("ui-pgrid-footer-count-container").each(function(){var t=e(this);if(n.pgrid_select)t.append(e('<span><span class="ui-pgrid-footer-count-select">0</span> selected of </span>'));t.append(e('<span><span class="ui-pgrid-footer-count-total">0</span> rows</span>'))}));n.update_selected()}}if(n.pgrid_footer){if(n.pgrid_resize){var o;var u;var a=function(e){u+=e.pageY-o;o=e.pageY;n.pgrid_table_viewport.css("height",u+"px");return false};n.footer.append(e("<div />").addClass("ui-pgrid-footer-resize-container").append(e('<span class="ui-icon ui-icon-grip-solid-horizontal"></span>')).mousedown(function(t){o=t.pageY;u=n.pgrid_table_viewport.height();e("body").delegate("*","mousemove",a)}).mouseup(function(t){e("body").undelegate("*","mousemove",a);n.state_changed()}))}}if(n.pgrid_toolbar)n.pgrid_widget.append(e("<div />").addClass("ui-pgrid-toolbar-container ui-widget-header ui-corner-top").append(n.toolbar));n.pgrid_widget.append(n.pgrid_table_viewport);if(n.pgrid_footer)n.pgrid_widget.append(n.footer);n.pgrid_widget.append(n.pgrid_header_select);this.pines_grid=n;n.trigger("pgrid_loaded.pgrid")});return this};var t=function(e){if(encodeURIComponent)return encodeURIComponent(e);else return escape(e)};e.fn.pgrid.defaults={pgrid_toolbar:false,pgrid_toolbar_contents:[],pgrid_toolbar_target:"_self",pgrid_footer:true,pgrid_count:true,pgrid_select:true,pgrid_multi_select:true,pgrid_click:null,pgrid_double_click:null,pgrid_paginate:true,pgrid_page:0,pgrid_perpage:15,pgrid_filtering:true,pgrid_filter:"",pgrid_hidden_cols:[],pgrid_resize_cols:true,pgrid_sortable:true,pgrid_sort_col:1,pgrid_sort_ord:"asc",pgrid_decimal_sep:".",pgrid_child_prefix:"",pgrid_row_hover_effect:true,pgrid_view_height:"420px",pgrid_resize:true,pgrid_state_change:null,pgrid_stateful_height:true}})(jQuery);